# Diagramas de Flujos Detallados - Zecu

## ๐ฏ Flujo Principal del Sistema

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                              LANDING PAGE                                      โ
โโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                  โ
                  โผ
    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ                           DECISIรN DEL USUARIO                             โ
    โโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
              โ                         โ
              โผ                         โผ
    โโโโโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ   PRUEBA GRATUITA   โ    โ           PLANES PAGOS                       โ
    โ   (7 dรญas gratis)   โ    โ        (Bรกsico/Premium)                     โ
    โโโโโโโโโโโฌโโโโโโโโโโโโ    โโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
              โ                         โ
              โผ                         โผ
    โโโโโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ   MODAL ONBOARDING  โ    โ         BOTรN DE PAGO                       โ
    โ                     โ    โ                                             โ
    โ 1. Bienvenida       โ    โ  โข Plan Bรกsico (AR$1.999)                  โ
    โ 2. Ingresa WhatsApp โ    โ  โข Plan Premium (AR$5.999)                 โ
    โ 3. Redirige WhatsAppโ    โ                                             โ
    โโโโโโโโโโโฌโโโโโโโโโโโโ    โโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
              โ                         โ
              โผ                         โผ
    โโโโโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ   VALIDACIรN API    โ    โ         MERCADO PAGO                        โ
    โ                     โ    โ                                             โ
    โ POST /subscriptions โ    โ  โข Formulario de pago                       โ
    โ /free-plan          โ    โ  โข Procesamiento seguro                     โ
    โ                     โ    โ  โข Webhook de confirmaciรณn                  โ
    โโโโโโโโโโโฌโโโโโโโโโโโโ    โโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
              โ                         โ
              โผ                         โผ
    โโโโโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ   CREACIรN EN       โ    โ         WEBHOOK DE PAGO                     โ
    โ   SUPABASE          โ    โ                                             โ
    โ                     โ    โ  โข Recibe confirmaciรณn                      โ
    โ Estado: PENDING     โ    โ  โข Valida pago                             โ
    โ Duraciรณn: 7 dรญas    โ    โ  โข Actualiza suscripciรณn                   โ
    โโโโโโโโโโโฌโโโโโโโโโโโโ    โโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
              โ                         โ
              โผ                         โผ
    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ                              n8n WORKFLOW                                 โ
    โ                                                                             โ
    โ  โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
    โ  โ   Webhook       โโโโโถโ   Procesar      โโโโโถโ   Actualizar Supabase   โ โ
    โ  โ   Receiver      โ    โ   Evento        โ    โ                         โ โ
    โ  โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
    โ                                                         โ                 โ
    โ  โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ            โ                 โ
    โ  โ   Enviar        โโโโโโ   Determinar    โโโโโโโโโโโโโโ                 โ
    โ  โ   Notificaciรณn  โ    โ   Acciรณn        โ                              โ
    โ  โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ                              โ
    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
              โ                         โ
              โผ                         โผ
    โโโโโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ   WHATSAPP BOT      โ    โ         EMAIL SERVICE                       โ
    โ                     โ    โ                                             โ
    โ  โข Mensaje bienvenidaโ   โ  โข Confirmaciรณn de pago                    โ
    โ  โข Procesa respuestasโ   โ  โข Notificaciones de cambio                โ
    โ  โข Activa suscripciรณnโ   โ  โข Recordatorios de renovaciรณn             โ
    โโโโโโโโโโโฌโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
              โ
              โผ
    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ                           USUARIO ACTIVO                                  โ
    โ                                                                             โ
    โ  โข Suscripciรณn activa en Supabase                                          โ
    โ  โข Puede usar el servicio                                                  โ
    โ  โข Recibe notificaciones                                                   โ
    โโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                      โ
                      โผ
    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ                        DASHBOARD DE USUARIO                                โ
    โ                                                                             โ
    โ  โโโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
    โ  โ   Ver Plan      โ  โ   Cambiar Plan  โ  โ   Cancelar Suscripciรณn      โ โ
    โ  โ   Actual        โ  โ                 โ  โ                             โ โ
    โ  โโโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
    โ                                                         โ                 โ
    โ  โโโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโ            โ                 โ
    โ  โ   Historial     โ  โ   Anรกlisis      โ            โ                 โ
    โ  โ   de Uso        โ  โ   Realizados    โ            โ                 โ
    โ  โโโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโ            โ                 โ
    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโ
                                                          โ
                                                          โผ
    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ                        GESTIรN DE SUSCRIPCIONES                            โ
    โ                                                                             โ
    โ  โโโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
    โ  โ   UPGRADE       โ  โ   DOWNGRADE     โ  โ   CANCELACIรN               โ โ
    โ  โ                 โ  โ                 โ  โ                             โ โ
    โ  โ โข Nuevo pago    โ  โ โข Proceso       โ  โ โข Confirmaciรณn              โ โ
    โ  โ โข Actualizaciรณn โ  โ   automรกtico    โ  โ โข Proceso inmediato         โ โ
    โ  โ โข Notificaciรณn  โ  โ โข Notificaciรณn  โ  โ โข Notificaciรณn              โ โ
    โ  โโโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ๐ Flujo de Estados de Suscripciรณn

```
โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ
โ   PENDING   โโโโโถโ   ACTIVE    โโโโโถโ   EXPIRED   โโโโโถโ CANCELLED   โ
โ             โ    โ             โ    โ             โ    โ             โ
โ โข Creada    โ    โ โข Activada  โ    โ โข Expirada  โ    โ โข Cancelada โ
โ โข Esperando โ    โ โข En uso    โ    โ โข Sin accesoโ    โ โข Finalizadaโ
โ   activaciรณnโ    โ โข Funcional โ    โ โข Puede     โ    โ             โ
โ             โ    โ             โ    โ   renovar   โ    โ             โ
โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ
       โ                   โ                   โ                   โ
       โ                   โ                   โ                   โ
       โผ                   โผ                   โผ                   โผ
โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ
โ   UPGRADED  โ    โ DOWNGRADED  โ    โ   RENEWED   โ    โ   [END]     โ
โ             โ    โ             โ    โ             โ    โ             โ
โ โข Plan      โ    โ โข Plan      โ    โ โข Plan      โ    โ โข Proceso   โ
โ   superior  โ    โ   inferior  โ    โ   renovado  โ    โ   terminado โ
โ โข Nuevo     โ    โ โข Cambio    โ    โ โข Nuevo     โ    โ             โ
โ   pago      โ    โ   automรกticoโ    โ   perรญodo   โ    โ             โ
โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ
```

## ๐๏ธ Arquitectura de Integraciรณn

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                                FRONTEND                                        โ
โ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โ   Landing   โ  โ  Dashboard  โ  โ   Admin     โ  โ    Payment Pages        โ โ
โ  โ    Page     โ  โ   Usuario   โ  โ   Panel     โ  โ                         โ โ
โ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                  โ
                  โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                              BACKEND - ZECU                                   โ
โ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โ   API       โ  โ  Webhook    โ  โ  Services   โ  โ    Utils & Helpers      โ โ
โ  โ   Routes    โ  โ  Handlers   โ  โ             โ  โ                         โ โ
โ  โ             โ  โ             โ  โ โข Subscriptionโ  โ โข Validation           โ โ
โ  โ โข /subscriptionsโ โข /mercadopagoโ  โ   Service   โ  โ โข Formatting           โ โ
โ  โ โข /payments โ  โ โข /whatsapp โ  โ โข Plan       โ  โ โข Security             โ โ
โ  โ โข /users    โ  โ โข /n8n      โ  โ   Service    โ  โ โข Logging              โ โ
โ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                  โ
                  โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                              INTEGRACIONES                                    โ
โ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โ  Mercado    โ  โ  WhatsApp   โ  โ    Email    โ  โ      Analytics          โ โ
โ  โ   Pago      โ  โ     Bot     โ  โ   Service   โ  โ                         โ โ
โ  โ             โ  โ             โ  โ             โ  โ โข Google Analytics      โ โ
โ  โ โข Pagos     โ  โ โข Mensajes  โ  โ โข SendGrid  โ  โ โข Custom Events         โ โ
โ  โ โข Webhooks  โ  โ โข Comandos  โ  โ โข Templates โ  โ โข User Tracking         โ โ
โ  โ โข Refunds   โ  โ โข Respuestasโ  โ โข Notificationsโ โ โข Conversion Tracking  โ โ
โ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                  โ
                  โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                              ORQUESTACIรN                                     โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โ                              n8n WORKFLOWS                                โ โ
โ  โ                                                                             โ โ
โ  โ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโ โ โ
โ  โ  โ  Webhook    โ  โ  Process    โ  โ  Database   โ  โ    Notifications    โ โ โ
โ  โ  โ  Receiver   โ  โ   Events    โ  โ   Updates   โ  โ                     โ โ โ
โ  โ  โ             โ  โ             โ  โ             โ  โ โข WhatsApp          โ โ โ
โ  โ  โ โข Subscriptionโ  โ โข Business  โ  โ โข Supabase  โ  โ โข Email             โ โ โ
โ  โ  โ โข Payment   โ  โ   Logic     โ  โ โข Updates   โ  โ โข SMS               โ โ โ
โ  โ  โ โข WhatsApp  โ  โ โข Validationโ  โ โข Queries   โ  โ โข Push              โ โ โ
โ  โ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโ โ โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                  โ
                  โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                              BASE DE DATOS                                    โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โ                              SUPABASE                                      โ โ
โ  โ                                                                             โ โ
โ  โ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโ โ โ
โ  โ  โ Subscriptionsโ  โ    Users    โ  โ  Analyses   โ  โ      Features       โ โ โ
โ  โ  โ             โ  โ             โ  โ             โ  โ                     โ โ โ
โ  โ  โ โข Plan info โ  โ โข Profile   โ  โ โข Messages  โ  โ โข Feature flags     โ โ โ
โ  โ  โ โข Status    โ  โ โข WhatsApp  โ  โ โข Results   โ  โ โข Usage limits      โ โ โ
โ  โ  โ โข Dates     โ  โ โข Email     โ  โ โข Timestampsโ  โ โข Access control    โ โ โ
โ  โ  โ โข Metadata  โ  โ โข Settings  โ  โ โข Confidenceโ  โ โข Permissions       โ โ โ
โ  โ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโ โ โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ๐ Flujo de Datos entre Componentes

```
โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ
โ   Usuario   โโโโโถโ   Frontend  โโโโโถโ   Zecu API  โโโโโถโ     n8n     โ
โ             โ    โ             โ    โ             โ    โ             โ
โ โข Acciones  โ    โ โข UI/UX     โ    โ โข Business  โ    โ โข Workflows โ
โ โข Datos     โ    โ โข Forms     โ    โ   Logic     โ    โ โข Processingโ
โ โข Feedback  โ    โ โข Validationโ    โ โข Security  โ    โ โข Routing   โ
โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ
                                                                    โ
                                                                    โผ
โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ
โ  Supabase   โโโโโโ  External   โโโโโโ   n8n       โโโโโโ   Zecu     โ
โ             โ    โ  Services   โ    โ             โ    โ   API       โ
โ โข Database  โ    โ             โ    โ โข Webhooks  โ    โ             โ
โ โข Auth      โ    โ โข WhatsApp  โ    โ โข Logic     โ    โ โข Events    โ
โ โข Storage   โ    โ โข Email     โ    โ โข Routing   โ    โ โข Data      โ
โ โข Functions โ    โ โข SMS       โ    โ โข Processingโ    โ โข Validationโ
โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ
```

## ๐ฏ Puntos Crรญticos del Sistema

### **1. Validaciรณn de Datos**
```
Usuario โ Frontend โ API โ n8n โ Supabase
   โ         โ        โ     โ        โ
   โผ         โผ        โผ     โผ        โผ
Validaciรณn โ Sanitizaciรณn โ Verificaciรณn โ Procesamiento โ Almacenamiento
```

### **2. Manejo de Errores**
```
Error โ Logging โ Notificaciรณn โ Recuperaciรณn โ Continuidad
  โ        โ          โ            โ            โ
  โผ        โผ          โผ            โผ            โผ
Detectado โ Registrado โ Alertado โ Procesado โ Resuelto
```

### **3. Seguridad**
```
Request โ Authentication โ Authorization โ Validation โ Processing
   โ            โ              โ             โ            โ
   โผ            โผ              โผ             โผ            โผ
Recibido โ Verificado โ Autorizado โ Validado โ Procesado
```

---

**Nota**: Estos diagramas representan la arquitectura completa del sistema Zecu, mostrando todos los flujos de usuario, integraciones y puntos de conexiรณn entre los diferentes componentes.



